CREATE DATABASE StockMarket;
USE StockMarket;

CREATE TABLE cryptocurrency (
  timestamp DATETIME,
  name VARCHAR(255),
  symbol VARCHAR(255),
  price_usd DECIMAL(20, 10),
  vol_24h VARCHAR(255),
  total_vol VARCHAR(255),
  chg_24h VARCHAR(255),
  chg_7d VARCHAR(255),
  market_cap VARCHAR(255)
);

INSERT INTO cryptocurrency (timestamp, name, symbol, price_usd, vol_24h, total_vol, chg_24h, chg_7d, market_cap) VALUES
('2025-09-18 11:05:13', 'Ethena USDe', 'eUSDe', 1.001, '$126.44M', '0.10%', '-0.02%', '+0.03%', '$13.68B'),
('2025-09-18 11:05:13', 'Stellar', 'XLM', 0.39715, '$303.47M', '0.14%', '+1.86%', '+1.76%', '$12.58B'),
('2025-09-18 11:05:13', 'Hedera', 'HBAR', 0.24659, '$400.19M', '0.18%', '+2.95%', '+3.59%', '$10.40B'),
('2025-09-18 11:05:13', 'Hyperliquid', 'HYPE', 58.5832, '$466.51M', '0.20%', '+6.84%', '+5.74%', '$19.60B'),
('2025-09-18 11:05:13', 'Bitcoin Cash', 'BCH', 634.61, '$1.33B', '0.35%', '+4.97%', '+5.44%', '$12.59B'),
('2025-09-18 11:05:13', 'Avalanche', 'AVAX', 32.88, '$1.72B', '0.51%', '+8.06%', '+13.46%', '$13.78B'),
('2025-09-18 11:05:13', 'TRON', 'TRX', 0.344113, '$974.64M', '0.51%', '+0.41%', '-0.34%', '$32.53B'),
('2025-09-18 11:05:13', 'Chainlink', 'LINK', 24.02, '$1.26B', '0.59%', '+1.34%', '+0.16%', '$16.18B'),
('2025-09-18 11:05:13', 'Sui', 'SUI', 3.8003, '$1.72B', '0.74%', '+4.67%', '+4.72%', '$13.53B'),
('2025-09-18 11:05:13', 'Cardano', 'ADA', 0.9121, '$2.12B', '0.92%', '+2.32%', '+1.96%', '$32.35B'),
('2025-09-18 11:05:13', 'BNB', 'BNB', 998.7, '$3.79B', '1.75%', '+4.28%', '+11.43%', '$138.85B'),
('2025-09-18 11:05:13', 'USDC', 'USDC', 0.9996, '$35.56B', '12.74%', '-0.03%', '+0.00%', '$73.60B'),
('2025-09-18 11:05:13', 'Dogecoin', 'DOGE', 0.279961, '$5.41B', '2.45%', '+3.54%', '+11.66%', '$42.06B'),
('2025-09-18 11:05:13', 'Ethereum', 'ETH', 4578.27, '$46.21B', '24.32%', '+0.70%', '+3.21%', '$552.42B'),
('2025-09-18 11:05:13', 'XRP', 'XRP', 3.1, '$6.94B', '3.20%', '+1.23%', '+2.62%', '$183.87B'),
('2025-09-18 11:05:13', 'Bitcoin', 'BTC', 117157.70, '$67.34B', '33.14%', '-0.12%', '+2.62%', '$2.33T'),
('2025-09-18 11:05:13', 'Solana', 'SOL', 244.881, '$10.82B', '5.30%', '+2.95%', '+9.96%', '$132.95B'),
('2025-09-18 11:05:13', 'Tether USDt', 'USDT', 1.0002, '$175.63B', '81.60%', '-0.03%', '-0.01%', '$170.96B'),
('2025-09-18 10:35:12', 'UNUS SED LEO', 'LEOu', 9.5618, '$901.26K', '0.00%', '+0.19%', '-0.39%', '$8.80B'),
('2025-09-18 10:35:12', 'Ethena USDe', 'eUSDe', 1.001, '$164.17M', '0.10%', '-0.01%', '+0.02%', '$13.68B'),
('2025-09-18 10:35:12', 'Stellar', 'XLM', 0.39527, '$304.38M', '0.14%', '+2.06%', '+1.29%', '$12.56B'),
('2025-09-18 10:35:12', 'Hedera', 'HBAR', 0.24492, '$398.65M', '0.18%', '+2.25%', '+2.68%', '$10.34B'),
('2025-09-18 10:35:12', 'Hyperliquid', 'HYPE', 58.503, '$468.91M', '0.20%', '+5.39%', '+5.00%', '$19.46B'),
('2025-09-18 10:35:12', 'Litecoin', 'LTC', 115.4, '$711.20M', '0.34%', '-0.14%', '-1.51%', '$8.79B'),
('2025-09-18 10:35:12', 'Bitcoin Cash', 'BCH', 632.84, '$1.32B', '0.35%', '+5.56%', '+6.79%', '$12.63B'),
('2025-09-18 10:35:12', 'Avalanche', 'AVAX', 32.55, '$1.69B', '0.51%', '+8.18%', '+13.20%', '$13.75B'),
('2025-09-18 10:35:12', 'TRON', 'TRX', 0.343668, '$984.78M', '0.51%', '+0.55%', '-0.25%', '$32.55B'),
('2025-09-18 10:35:12', 'Chainlink', 'LINK', 23.83, '$1.26B', '0.59%', '+1.15%', '-0.10%', '$16.15B'),
('2025-09-18 10:35:12', 'Sui', 'SUI', 3.7959, '$1.70B', '0.74%', '+4.88%', '+4.45%', '$13.53B'),
('2025-09-18 10:35:12', 'Cardano', 'ADA', 0.9037, '$2.13B', '0.92%', '+2.57%', '+1.75%', '$32.35B'),
('2025-09-18 10:35:12', 'Dogecoin', 'DOGE', 0.27914, '$5.43B', '2.45%', '+3.58%', '+11.22%', '$42.05B'),
('2025-09-18 10:35:12', 'USDC', 'USDC', 0.9995, '$35.48B', '12.74%', '-0.03%', '-0.02%', '$73.60B'),
('2025-09-18 10:35:12', 'Tether USDt', 'USDT', 1.0001, '$176.62B', '81.60%', '-0.03%', '+0.00%', '$170.98B'),
('2025-09-18 10:35:12', 'Bitcoin', 'BTC', 117199.90, '$67.77B', '33.14%', '-0.12%', '+2.33%', '$2.33T'),
('2025-09-18 10:35:12', 'Solana', 'SOL', 244.964, '$10.93B', '5.30%', '+3.33%', '+9.25%', '$132.55B'),
('2025-09-18 10:35:12', 'XRP', 'XRP', 3.0754, '$6.95B', '3.20%', '+1.51%', '+2.32%', '$183.54B'),
('2025-09-18 10:35:12', 'Ethereum', 'ETH', 4581.32, '$48.24B', '24.32%', '+0.54%', '+2.94%', '$551.80B'),
('2025-09-18 10:35:12', 'BNB', 'BNB', 996.3, '$3.76B', '1.75%', '+4.20%', '+10.81%', '$138.37B'),
('2025-09-18 10:05:13', 'Hedera', 'HBAR', 0.2437, '$397.30M', '0.18%', '+2.23%', '+2.49%', '$10.30B'),
('2025-09-18 10:05:13', 'Dogecoin', 'DOGE', 0.278417, '$5.43B', '2.45%', '+3.57%', '+10.70%', '$41.96B'),
('2025-09-18 10:05:13', 'TRON', 'TRX', 0.343985, '$988.31M', '0.51%', '+0.87%', '-0.14%', '$32.59B'),
('2025-09-18 10:05:13', 'Stellar', 'XLM', 0.3943, '$304.84M', '0.14%', '+2.39%', '+1.43%', '$12.53B'),
('2025-09-18 10:05:13', 'Cardano', 'ADA', 0.9041, '$2.13B', '0.92%', '+2.74%', '+1.66%', '$32.32B'),
('2025-09-18 10:05:13', 'USDC', 'USDC', 0.9995, '$35.74B', '12.74%', '-0.03%', '0.00%', '$73.60B'),
('2025-09-18 10:05:13', 'Tether USDt', 'USDT', 1.0002, '$177.15B', '81.60%', '-0.03%', '+0.01%', '$170.97B'),
('2025-09-18 10:05:13', 'Ethena USDe', 'eUSDe', 1.001, '$165.04M', '0.10%', '-0.04%', '+0.01%', '$13.68B'),
('2025-09-18 10:05:13', 'Litecoin', 'LTC', 116.34, '$693.51M', '0.34%', '+1.04%', '-0.59%', '$8.86B'),
('2025-09-18 10:05:13', 'Bitcoin', 'BTC', 117067.50, '$67.84B', '33.14%', '-0.08%', '+2.31%', '$2.33T'),
('2025-09-18 10:05:13', 'Chainlink', 'LINK', 23.82, '$1.26B', '0.59%', '+1.49%', '-0.27%', '$16.12B'),
('2025-09-18 10:05:13', 'Solana', 'SOL', 244.015, '$10.94B', '5.30%', '+3.42%', '+9.16%', '$132.30B'),
('2025-09-18 10:05:13', 'XRP', 'XRP', 3.0705, '$6.94B', '3.20%', '+1.45%', '+2.01%', '$183.10B'),
('2025-09-18 10:05:13', 'Sui', 'SUI', 3.7833, '$1.69B', '0.74%', '+4.42%', '+4.03%', '$13.46B'),
('2025-09-18 10:05:13', 'Avalanche', 'AVAX', 32.54, '$1.68B', '0.51%', '+8.39%', '+13.34%', '$13.74B'),
('2025-09-18 10:05:13', 'Ethereum', 'ETH', 4570.11, '$48.74B', '24.32%', '+0.77%', '+3.07%', '$551.26B'),
('2025-09-18 10:05:13', 'Hyperliquid', 'HYPE', 58.2599, '$470.00M', '0.20%', '+5.88%', '+5.29%', '$19.44B'),
('2025-09-18 10:05:13', 'Bitcoin Cash', 'BCH', 634.49, '$1.31B', '0.35%', '+5.78%', '+6.67%', '$12.63B'),
('2025-09-18 10:05:13', 'UNUS SED LEO', 'LEOu', 9.558, '$904.22K', '0.00%', '-0.17%', '-0.37%', '$8.80B'),
('2025-09-18 10:05:13', 'BNB', 'BNB', 994.4, '$3.75B', '1.75%', '+4.15%', '+10.55%', '$138.00B'),
('2025-09-18 09:35:12', 'Litecoin', 'LTC', 116.14, '$687.75M', '0.34%', '+1.33%', '-0.28%', '$8.87B'),
('2025-09-18 09:35:12', 'UNUS SED LEO', 'LEOu', 9.5555, '$908.79K', '0.00%', '+0.00%', '-0.38%', '$8.80B'),
('2025-09-18 09:35:12', 'Ethena USDe', 'eUSDe', 1.001, '$169.26M', '0.10%', '-0.02%', '+0.03%', '$13.68B'),
('2025-09-18 09:35:12', 'Stellar', 'XLM', 0.39328, '$302.74M', '0.14%', '+2.55%', '+1.89%', '$12.54B'),
('2025-09-18 09:35:12', 'Hedera', 'HBAR', 0.24273, '$393.48M', '0.18%', '+2.09%', '+2.69%', '$10.28B');



CREATE TABLE stocks (
  timestamp DATETIME,
  name VARCHAR(255),
  last DECIMAL(10, 2),
  high DECIMAL(10, 2),
  low DECIMAL(10, 2),
  chg_ DECIMAL(10, 2),
  chg_percent VARCHAR(255),
  vol_ VARCHAR(255),
  time VARCHAR(255)
);

INSERT INTO stocks (timestamp, name, last, high, low, chg_, chg_percent, vol_, time) VALUES
('2025-09-18 11:30:01', 'Boeing', 214.63, 218.05, 213.13, -0.39, '-0.18%', '6.02M', '17/09'),
('2025-09-18 11:30:01', 'Chevron', 160.09, 160.67, 158.61, 0.55, '+0.34%', '5.74M', '17/09'),
('2025-09-18 11:30:01', 'Citigroup', 101.76, 102.21, 100.41, 1.12, '+1.11%', '14.37M', '17/09'),
('2025-09-18 11:30:01', 'Caterpillar', 450.66, 452.34, 443.00, 9.99, '+2.27%', '4.51M', '17/09'),
('2025-09-18 11:30:01', 'Microsoft', 510.02, 511.29, 505.93, 0.98, '+0.19%', '15.82M', '17/09'),
('2025-09-18 11:30:01', 'Walt Disney', 116.10, 116.66, 115.22, 0.87, '+0.76%', '7.33M', '17/09'),
('2025-09-18 11:30:01', 'Cisco', 67.72, 67.88, 66.38, 0.79, '+1.18%', '18.65M', '17/09'),
('2025-09-18 11:30:01', 'Goldman Sachs', 794.22, 798.57, 785.23, 8.69, '+1.11%', '1.95M', '17/09'),
('2025-09-18 11:30:01', 'JPMorgan', 311.75, 312.91, 308.77, 2.56, '+0.83%', '8.66M', '17/09'),
('2025-09-18 11:30:01', 'Coca-Cola', 67.04, 67.13, 66.41, 0.80, '+1.21%', '17.37M', '17/09'),
('2025-09-18 11:30:01', 'McDonaldâ€™s', 304.97, 306.58, 303.91, 1.68, '+0.55%', '2.68M', '17/09'),
('2025-09-18 11:30:01', 'Merck&Co', 81.14, 82.25, 80.80, 0.05, '+0.06%', '12.64M', '17/09'),
('2025-09-18 11:30:01', '3M', 155.16, 158.54, 153.54, -1.34, '-0.86%', '2.76M', '17/09'),
('2025-09-18 11:30:01', 'Apple', 238.99, 240.10, 237.73, 0.84, '+0.35%', '46.51M', '17/09'),
('2025-09-18 11:30:01', 'Amazon.com', 231.62, 234.30, 228.71, -2.43, '-1.04%', '42.82M', '17/09'),
('2025-09-18 11:00:00', 'NVIDIA', 170.29, 173.20, 168.41, -4.59, '-2.62%', '211.84M', '17/09'),
('2025-09-18 11:00:00', 'Sherwin-Williams', 350.21, 359.21, 348.50, -2.99, '-0.85%', '2.17M', '17/09'),
('2025-09-18 11:00:00', 'Walmart', 104.27, 106.11, 103.73, 0.85, '+0.82%', '25.38M', '17/09'),
('2025-09-18 11:00:00', 'Home Depot', 417.00, 426.75, 415.81, -4.45, '-1.06%', '4.77M', '17/09'),
('2025-09-18 11:00:00', 'IBM', 259.08, 260.96, 257.01, 1.56, '+0.61%', '3.97M', '17/09'),
('2025-09-18 11:00:00', 'Verizon', 44.21, 44.41, 43.86, 0.47, '+1.07%', '14.41M', '17/09'),
('2025-09-18 11:00:00', 'Travelers', 275.03, 276.80, 272.13, 3.08, '+1.13%', '982.39K', '17/09'),
('2025-09-18 11:00:00', 'J&J', 177.20, 178.51, 176.59, 0.74, '+0.42%', '6.72M', '17/09'),
('2025-09-18 11:00:00', 'American Express', 336.00, 337.50, 328.40, 8.96, '+2.74%', '3.59M', '17/09'),
('2025-09-18 11:00:00', 'Honeywell', 211.68, 213.65, 210.25, 0.73, '+0.35%', '5.41M', '17/09'),
('2025-09-18 11:00:00', 'Salesforce Inc', 242.21, 243.00, 239.38, 2.90, '+1.21%', '10.12M', '17/09'),
('2025-09-18 11:00:00', 'Visa A', 346.20, 346.20, 339.52, 6.17, '+1.81%', '5.76M', '17/09'),
('2025-09-18 11:00:00', 'UnitedHealth', 341.61, 343.00, 337.69, 1.83, '+0.54%', '8.47M', '17/09'),
('2025-09-18 11:00:00', 'Nike', 72.31, 73.32, 71.61, -0.44, '-0.60%', '11.11M', '17/09'),
('2025-09-18 11:00:00', 'P&G', 160.33, 161.67, 158.43, 2.28, '+1.44%', '6.76M', '17/09'),
('2025-09-18 11:00:00', 'Boeing', 214.63, 218.05, 213.13, -0.39, '-0.18%', '6.02M', '17/09'),
('2025-09-18 11:00:00', 'Chevron', 160.09, 160.67, 158.61, 0.55, '+0.34%', '5.74M', '17/09'),
('2025-09-18 11:00:00', 'Citigroup', 101.76, 102.21, 100.41, 1.12, '+1.11%', '14.37M', '17/09'),
('2025-09-18 11:00:00', 'Caterpillar', 450.66, 452.34, 443.00, 9.99, '+2.27%', '4.51M', '17/09'),
('2025-09-18 11:00:00', 'Microsoft', 510.02, 511.29, 505.93, 0.98, '+0.19%', '15.82M', '17/09'),
('2025-09-18 11:00:00', 'Walt Disney', 116.10, 116.66, 115.22, 0.87, '+0.76%', '7.33M', '17/09'),
('2025-09-18 11:00:00', 'Cisco', 67.72, 67.88, 66.38, 0.79, '+1.18%', '18.65M', '17/09'),
('2025-09-18 11:00:00', 'Goldman Sachs', 794.22, 798.57, 785.23, 8.69, '+1.11%', '1.95M', '17/09'),
('2025-09-18 11:00:00', 'JPMorgan', 311.75, 312.91, 308.77, 2.56, '+0.83%', '8.66M', '17/09'),
('2025-09-18 11:00:00', 'Coca-Cola', 67.04, 67.13, 66.41, 0.80, '+1.21%', '17.37M', '17/09'),
('2025-09-18 11:00:00', 'McDonaldâ€™s', 304.97, 306.58, 303.91, 1.68, '+0.55%', '2.68M', '17/09'),
('2025-09-18 11:00:00', 'Merck&Co', 81.14, 82.25, 80.80, 0.05, '+0.06%', '12.64M', '17/09'),
('2025-09-18 11:00:00', '3M', 155.16, 158.54, 153.54, -1.34, '-0.86%', '2.76M', '17/09'),
('2025-09-18 11:00:00', 'Apple', 238.99, 240.10, 237.73, 0.84, '+0.35%', '46.51M', '17/09'),
('2025-09-18 11:00:00', 'Amazon.com', 231.62, 234.30, 228.71, -2.43, '-1.04%', '42.82M', '17/09'),
('2025-09-18 11:00:00', 'Amgen', 274.71, 277.80, 273.00, 1.63, '+0.60%', '1.75M', '17/09'),
('2025-09-18 10:30:00', 'Sherwin-Williams', 350.21, 359.21, 348.50, -2.99, '-0.85%', '2.17M', '17/09'),
('2025-09-18 10:30:00', 'Walmart', 104.27, 106.11, 103.73, 0.85, '+0.82%', '25.38M', '17/09'),
('2025-09-18 10:30:00', 'Home Depot', 417.00, 426.75, 415.81, -4.45, '-1.06%', '4.77M', '17/09'),
('2025-09-18 10:30:00', 'IBM', 259.08, 260.96, 257.01, 1.56, '+0.61%', '3.97M', '17/09'),
('2025-09-18 10:30:00', 'Verizon', 44.21, 44.41, 43.86, 0.47, '+1.07%', '14.41M', '17/09'),
('2025-09-18 10:30:00', 'Travelers', 275.03, 276.80, 272.13, 3.08, '+1.13%', '982.39K', '17/09'),
('2025-09-18 10:30:00', 'J&J', 177.20, 178.51, 176.59, 0.74, '+0.42%', '6.72M', '17/09'),
('2025-09-18 10:30:00', 'American Express', 336.00, 337.50, 328.40, 8.96, '+2.74%', '3.59M', '17/09'),
('2025-09-18 10:30:00', 'Honeywell', 211.68, 213.65, 210.25, 0.73, '+0.35%', '5.41M', '17/09'),
('2025-09-18 10:30:00', 'Salesforce Inc', 242.21, 243.00, 239.38, 2.90, '+1.21%', '10.12M', '17/09'),
('2025-09-18 10:30:00', 'Visa A', 346.20, 346.20, 339.52, 6.17, '+1.81%', '5.76M', '17/09'),
('2025-09-18 10:30:00', 'UnitedHealth', 341.61, 343.00, 337.69, 1.83, '+0.54%', '8.47M', '17/09'),
('2025-09-18 10:30:00', 'Nike', 72.31, 73.32, 71.61, -0.44, '-0.60%', '11.11M', '17/09'),
('2025-09-18 10:30:00', 'P&G', 160.33, 161.67, 158.43, 2.28, '+1.44%', '6.76M', '17/09'),
('2025-09-18 10:30:00', 'Boeing', 214.63, 218.05, 213.13, -0.39, '-0.18%', '6.02M', '17/09'),
('2025-09-18 10:30:00', 'Chevron', 160.09, 160.67, 158.61, 0.55, '+0.34%', '5.74M', '17/09'),
('2025-09-18 10:30:00', 'Citigroup', 101.76, 102.21, 100.41, 1.12, '+1.11%', '14.37M', '17/09'),
('2025-09-18 10:30:00', 'Caterpillar', 450.66, 452.34, 443.00, 9.99, '+2.27%', '4.51M', '17/09'),
('2025-09-18 10:30:00', 'Microsoft', 510.02, 511.29, 505.93, 0.98, '+0.19%', '15.82M', '17/09'),
('2025-09-18 10:30:00', 'Walt Disney', 116.10, 116.66, 115.22, 0.87, '+0.76%', '7.33M', '17/09'),
('2025-09-18 10:30:00', 'Cisco', 67.72, 67.88, 66.38, 0.79, '+1.18%', '18.65M', '17/09'),
('2025-09-18 10:30:00', 'Goldman Sachs', 794.22, 798.57, 785.23, 8.69, '+1.11%', '1.95M', '17/09'),
('2025-09-18 10:30:00', 'JPMorgan', 311.75, 312.91, 308.77, 2.56, '+0.83%', '8.66M', '17/09'),
('2025-09-18 10:30:00', 'Coca-Cola', 67.04, 67.13, 66.41, 0.80, '+1.21%', '17.37M', '17/09'),
('2025-09-18 10:30:00', 'McDonaldâ€™s', 304.97, 306.58, 303.91, 1.68, '+0.55%', '2.68M', '17/09'),
('2025-09-18 10:30:00', 'Merck&Co', 81.14, 82.25, 80.80, 0.05, '+0.06%', '12.64M', '17/09'),
('2025-09-18 10:30:00', '3M', 155.16, 158.54, 153.54, -1.34, '-0.86%', '2.76M', '17/09'),
('2025-09-18 10:30:00', 'Apple', 238.99, 240.10, 237.73, 0.84, '+0.35%', '46.51M', '17/09'),
('2025-09-18 10:30:00', 'Amazon.com', 231.62, 234.30, 228.71, -2.43, '-1.04%', '42.82M', '17/09'),
('2025-09-18 10:30:00', 'Amgen', 274.71, 277.80, 273.00, 1.63, '+0.60%', '1.75M', '17/09'),
('2025-09-18 10:30:00', 'NVIDIA', 170.29, 173.20, 168.41, -4.59, '-2.62%', '211.84M', '17/09'),
('2025-09-18 10:00:02', 'Walmart', 104.27, 106.11, 103.73, 0.85, '+0.82%', '25.38M', '17/09'),
('2025-09-18 10:00:02', 'Home Depot', 417.00, 426.75, 415.81, -4.45, '-1.06%', '4.77M', '17/09'),
('2025-09-18 10:00:02', 'IBM', 259.08, 260.96, 257.01, 1.56, '+0.61%', '3.97M', '17/09'),
('2025-09-18 10:00:02', 'Verizon', 44.21, 44.41, 43.86, 0.47, '+1.07%', '14.41M', '17/09'),
('2025-09-18 10:00:02', 'Travelers', 275.03, 276.80, 272.13, 3.08, '+1.13%', '982.39K', '17/09'),
('2025-09-18 10:00:02', 'J&J', 177.20, 178.51, 176.59, 0.74, '+0.42%', '6.72M', '17/09'),
('2025-09-18 10:00:02', 'American Express', 336.00, 337.50, 328.40, 8.96, '+2.74%', '3.59M', '17/09'),
('2025-09-18 10:00:02', 'Honeywell', 211.68, 213.65, 210.25, 0.73, '+0.35%', '5.41M', '17/09'),
('2025-09-18 10:00:02', 'Salesforce Inc', 242.21, 243.00, 239.38, 2.90, '+1.21%', '10.12M', '17/09'),
('2025-09-18 10:00:02', 'Visa A', 346.20, 346.20, 339.52, 6.17, '+1.81%', '5.76M', '17/09'),
('2025-09-18 10:00:02', 'UnitedHealth', 341.61, 343.00, 337.69, 1.83, '+0.54%', '8.47M', '17/09'),
('2025-09-18 10:00:02', 'Nike', 72.31, 73.32, 71.61, -0.44, '-0.60%', '11.11M', '17/09'),
('2025-09-18 10:00:02', 'P&G', 160.33, 161.67, 158.43, 2.28, '+1.44%', '6.76M', '17/09'),
('2025-09-18 10:00:02', 'Boeing', 214.63, 218.05, 213.13, -0.39, '-0.18%', '6.02M', '17/09'),
('2025-09-18 10:00:02', 'Chevron', 160.09, 160.67, 158.61, 0.55, '+0.34%', '5.74M', '17/09'),
('2025-09-18 10:00:02', 'Citigroup', 101.76, 102.21, 100.41, 1.12, '+1.11%', '14.37M', '17/09'),
('2025-09-18 10:00:02', 'Caterpillar', 450.66, 452.34, 443.00, 9.99, '+2.27%', '4.51M', '17/09'),
('2025-09-18 10:00:02', 'Microsoft', 510.02, 511.29, 505.93, 0.98, '+0.19%', '15.82M', '17/09'),
('2025-09-18 10:00:02', 'Walt Disney', 116.10, 116.66, 115.22, 0.87, '+0.76%', '7.33M', '17/09'),
('2025-09-18 10:00:02', 'Cisco', 67.72, 67.88, 66.38, 0.79, '+1.18%', '18.65M', '17/09'),
('2025-09-18 10:00:02', 'Goldman Sachs', 794.22, 798.57, 785.23, 8.69, '+1.11%', '1.95M', '17/09'),
('2025-09-18 10:00:02', 'JPMorgan', 311.75, 312.91, 308.77, 2.56, '+0.83%', '8.66M', '17/09'),
('2025-09-18 10:00:02', 'Coca-Cola', 67.04, 67.13, 66.41, 0.80, '+1.21%', '17.37M', '17/09'),
('2025-09-18 10:00:02', 'McDonaldâ€™s', 304.97, 306.58, 303.91, 1.68, '+0.55%', '2.68M', '17/09'),
('2025-09-18 10:00:02', 'Merck&Co', 81.14, 82.25, 80.80, 0.05, '+0.06%', '12.64M', '17/09'),
('2025-09-18 10:00:02', '3M', 155.16, 158.54, 153.54, -1.34, '-0.86%', '2.76M', '17/09'),
('2025-09-18 10:00:02', 'Apple', 238.99, 240.10, 237.73, 0.84, '+0.35%', '46.51M', '17/09'),
('2025-09-18 10:00:02', 'Amazon.com', 231.62, 234.30, 228.71, -2.43, '-1.04%', '42.82M', '17/09'),
('2025-09-18 10:00:02', 'Amgen', 274.71, 277.80, 273.00, 1.63, '+0.60%', '1.75M', '17/09'),
('2025-09-18 10:00:02', 'NVIDIA', 170.29, 173.20, 168.41, -4.59, '-2.62%', '211.84M', '17/09'),
('2025-09-18 10:00:02', 'Sherwin-Williams', 350.21, 359.21, 348.50, -2.99, '-0.85%', '2.17M', '17/09'),
('2025-09-18 10:00:02', 'Walmart', 104.27, 106.11, 103.73, 0.85, '+0.82%', '25.38M', '17/09'),
('2025-09-18 10:00:02', 'Home Depot', 417.00, 426.75, 415.81, -4.45, '-1.06%', '4.77M', '17/09'),
('2025-09-18 10:00:02', 'IBM', 259.08, 260.96, 257.01, 1.56, '+0.61%', '3.97M', '17/09'),
('2025-09-18 10:00:02', 'Verizon', 44.21, 44.41, 43.86, 0.47, '+1.07%', '14.41M', '17/09'),
('2025-09-18 10:00:02', 'Travelers', 275.03, 276.80, 272.13, 3.08, '+1.13%', '982.39K', '17/09'),
('2025-09-18 10:00:02', 'J&J', 177.20, 178.51, 176.59, 0.74, '+0.42%', '6.72M', '17/09'),
('2025-09-18 10:00:02', 'American Express', 336.00, 337.50, 328.40, 8.96, '+2.74%', '3.59M', '17/09'),
('2025-09-18 10:00:02', 'Honeywell', 211.68, 213.65, 210.25, 0.73, '+0.35%', '5.41M', '17/09'),
('2025-09-18 10:00:02', 'Salesforce Inc', 242.21, 243.00, 239.38, 2.90, '+1.21%', '10.12M', '17/09'),
('2025-09-18 10:00:02', 'Visa A', 346.20, 346.20, 339.52, 6.17, '+1.81%', '5.76M', '17/09'),
('2025-09-18 10:00:02', 'UnitedHealth', 341.61, 343.00, 337.69, 1.83, '+0.54%', '8.47M', '17/09'),
('2025-09-18 10:00:02', 'Nike', 72.31, 73.32, 71.61, -0.44, '-0.60%', '11.11M', '17/09'),
('2025-09-18 10:00:02', 'P&G', 160.33, 161.67, 158.43, 2.28, '+1.44%', '6.76M', '17/09');

SELECT * FROM cryptocurrency;
SELECT * FROM stocks;

-- Question ->
-- 1.Find the name and last price of all stocks.
SELECT name,last FROM stocks;

-- 2.List the name and price_usd for all cryptocurrencies.
SELECT name, price_usd FROM cryptocurrency;

-- 3.Get the name and chg_ for all stocks where the change is positive.
SELECT name ,chg_ FROM stocks WHERE chg_>0;

-- 4.Count the total number of records in the cryptocurrency table.
SELECT COUNT(*) AS Total_Records FROM cryptocurrency;

-- 5.Find the average last price for all stocks.
SELECT AVG(last) as Avg_Last_Price FROM stocks ;

-- 6.What is the highest price_usd among all cryptocurrencies?
SELECT MAX(price_usd) AS Max_price_usd FROM cryptocurrency;

-- 7.Calculate the total market_cap for all cryptocurrencies listed in the data.
SELECT MAX(CAST(REPLACE(REPLACE(REPLACE(price_usd, '$', ''), ',', ''), ' ', '') AS DECIMAL(15,2))) AS max_price
FROM cryptocurrency;

-- 8.List all stock names and their average last price, ordered by the average price in descending order.
SELECT name,AVG(last) as Avg_last_price FROM stocks GROUP BY name  ORDER BY Avg_last_price DESC;

-- 9.Find the name of the stock with the lowest low price.
SELECT name,low FROM stocks ORDER BY low ASC LIMIT 1;

-- 10.Find the stock with the highest high price for each unique timestamp.
SELECT s1.timestamp,s1.name,s1.high
FROM stocks s1
where s1.high = (
SELECT MAX(s2.high) FROM stocks s2 WHERE s2.timestamp = s1.timestamp
);

-- Advanced Questions ->

-- 11.List the average last price for each stock and the number of entries for each, but only for stocks with more than 5 entries.
SELECT name, AVG(last) AS avg_last, COUNT(*) AS total_entries
FROM stocks
GROUP BY name
HAVING COUNT(*) > 5;

-- 12.Use a subquery to find the names of cryptocurrencies that have a chg_24h higher than the overall average chg_24h.
SELECT chg_24h
FROM cryptocurrency
WHERE chg_24h > (SELECT AVG(chg_24h) FROM cryptocurrency);

-- 13.Join the stocks and cryptocurrency tables on their timestamp to find the name of the stock and the name of the cryptocurrency that were recorded at the same time.
SELECT s.timestamp, s.name AS stock_name, c.name AS crypto_name
FROM stocks s
JOIN cryptocurrency c
ON DATE(s.timestamp) = DATE(c.timestamp);

-- 14.Calculate the average last price for Microsoft and the average price_usd for Bitcoin side-by-side in a single query.
SELECT 
(SELECT AVG(last) FROM stocks WHERE name = "Microsoft") AS Microsoft_Avg_lastprice,
(SELECT AVG(price_usd) FROM cryptocurrency WHERE name = "Bitcoin") AS Bitcoin_Avg_price_usd;

-- 15.Find the stock with the largest difference between its high and low price.
SELECT name,(high-low) AS price_diff
FROM stocks
ORDER BY price_diff DESC LIMIT 1;

-- 16.Find the top 3 stocks with the highest chg_.
SELECT name,chg_
FROM stocks
ORDER BY chg_ DESC LIMIT 3;

-- 17.Write a query that displays the name, last, and the difference between the last price and the average last price of all stocks.
SELECT name, last,
       last - (SELECT AVG(last) FROM stocks) AS diff_from_avg
FROM stocks;

-- 18.Find all cryptocurrencies that have a chg_7d greater than 1% and a chg_24h less than 0%.
SELECT name, chg_7d, chg_24h
FROM cryptocurrency
WHERE chg_7d > 1 AND chg_24h < 0;

-- 19. For each stock, find the cryptocurrency that has the highest market_cap on the same date.
SELECT s.name AS stock_name, s.timestamp AS stock_time,
       c.name AS top_crypto, c.market_cap
FROM stocks s
JOIN cryptocurrency c
ON DATE(s.timestamp) = DATE(c.timestamp)
WHERE c.market_cap = (
    SELECT MAX(c2.market_cap)
    FROM cryptocurrency c2
    WHERE DATE(c2.timestamp) = DATE(s.timestamp)
);

-- 20.Count how many cryptos were recorded on the same date as each stock.
SELECT s.name AS stock_name, DATE(s.timestamp) AS record_date,
       COUNT(c.name) AS cryptos_on_same_day
FROM stocks s
LEFT JOIN cryptocurrency c
ON DATE(s.timestamp) = DATE(c.timestamp)
GROUP BY s.name, DATE(s.timestamp);

-- 21.Show daily average price of Microsoft vs. Bitcoin side by side.
SELECT DATE(s.timestamp) AS record_date,
       AVG(CAST(s.last AS REAL)) AS microsoft_avg,
       AVG(CAST(REPLACE(c.price_usd,'$','') AS REAL)) AS bitcoin_avg
FROM stocks s
JOIN cryptocurrency c
  ON DATE(s.timestamp) = DATE(c.timestamp)
WHERE s.name = 'Microsoft'
  AND c.name = 'Bitcoin'
GROUP BY DATE(s.timestamp)
ORDER BY record_date;


